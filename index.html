<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>BillCapture · Demo</title>
<style>
  :root{
    --brand:#0a84ff;        /* change brand color */
    --accent:#22c55e;       /* secondary accent */
    --bg:#f6f7f9;           /* page background */
    --card:#ffffff;         /* card background */
    --text:#111111;         /* body text */
    --muted:#6b7280;        /* muted text */
    --border:#e5e7eb;       /* border color */
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);font-family:system-ui,-apple-system,Arial;color:var(--text)}
  a{text-decoration:none}
  .wrap{max-width:420px;margin:0 auto;padding:16px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
  header{display:flex;align-items:center;gap:10px;margin-bottom:8px}
  header img{width:28px;height:28px;border-radius:6px}
  header h1{font-size:18px;margin:0}
  .muted{font-size:12px;color:var(--muted)}
  .step{display:none} .step.active{display:block}
  label{font-weight:600;display:block;margin:8px 0}
  input[type=file],input[type=text]{width:100%;padding:10px;border:1px solid var(--border);border-radius:8px}
  img.preview{width:100%;border-radius:10px;margin-top:10px}
  .btn{display:inline-block;padding:10px 14px;border-radius:10px;background:var(--brand);color:#fff;border:0;cursor:pointer}
  .btn.secondary{background:#6b7280}
  .btnbar{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .spinner{width:28px;height:28px;border:3px solid var(--border);border-top-color:var(--brand);border-radius:50%;animation:spin 1s linear infinite;margin:12px auto}
  @keyframes spin{to{transform:rotate(360deg)}}
  .docbox{border:1px solid var(--border);border-radius:10px;padding:12px;background:#fff}
  .notice{margin-top:10px;padding:8px;border:1px dashed var(--border);border-radius:8px;background:#fafafa}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" role="application" aria-label="Bill capture demo">
    <header>
      <img src="logo.png" alt="Company logo" onerror="this.style.display='none'">
      <h1>BillCapture · Demo</h1>
    </header>
    <p class="muted">Prototype for license review. Local only. No data is uploaded.</p>

    <!-- Step 1: Capture -->
    <section id="s1" class="step active" aria-label="Capture bill">
      <label for="file">Take or upload a bill photo</label>
      <input id="file" type="file" accept="image/*" capture="environment">
      <img id="preview" class="preview" style="display:none" alt="Bill preview">
      <div class="btnbar">
        <button id="scan" class="btn" disabled>Scan</button>
      </div>
      <div class="notice muted">Tip: open this page on your phone for the best experience.</div>
    </section>

    <!-- Step 2: “Scanning” -->
    <section id="s2" class="step" aria-label="Scanning in progress">
      <div class="spinner" role="status" aria-live="polite"></div>
      <p style="text-align:center">Scanning bill…</p>
    </section>

    <!-- Step 3: Review extracted fields -->
    <section id="s3" class="step" aria-label="Review fields">
      <label>Review extracted fields</label>
      <div class="grid">
        <input id="acct" placeholder="Account number" autocomplete="off">
        <input id="date" placeholder="Billing date" autocomplete="off">
      </div>
      <input id="name" placeholder="Customer name" style="margin-top:8px" autocomplete="off">
      <input id="total" placeholder="Total due" style="margin-top:8px" autocomplete="off">
      <div class="btnbar">
        <button id="toDoc" class="btn">Generate document</button>
        <button id="back1" class="btn secondary">Back</button>
      </div>
    </section>

    <!-- Step 4: Doc preview -->
    <section id="s4" class="step" aria-label="Document preview">
      <label>Document preview</label>
      <div id="doc" class="docbox"></div>
      <div class="btnbar">
        <button id="submit" class="btn">Submit</button>
        <button id="back2" class="btn secondary">Back</button>
      </div>
      <p class="muted">In production this would save to Google Docs. This demo renders locally.</p>
    </section>

    <!-- Step 5: Confirmation -->
    <section id="s5" class="step" aria-label="Confirmation">
      <p><strong>Submitted.</strong> Your bill has been captured and the form filled.</p>
      <div class="btnbar">
        <button id="restart" class="btn">Restart</button>
        <a class="btn secondary" href="#" id="print">Open printable preview</a>
      </div>
    </section>
  </div>
</div>

<script>
const qs = s=>document.querySelector(s);
const show = id => document.querySelectorAll('.step').forEach(el=>el.classList.toggle('active', el.id===id));

const file = qs('#file'), preview = qs('#preview'), scan = qs('#scan');
let fileURL = null;

file.addEventListener('change', e=>{
  const f = e.target.files && e.target.files[0];
  if(!f) return;
  if (fileURL) URL.revokeObjectURL(fileURL);
  fileURL = URL.createObjectURL(f);
  preview.src = fileURL; preview.style.display = 'block';
  scan.disabled = false;
});

scan.addEventListener('click', ()=>{
  show('s2');
  setTimeout(()=>{ // simulate OCR results
    qs('#acct').value = 'ACCT-' + Math.floor(100000+Math.random()*900000);
    qs('#name').value = 'Sample Customer';
    qs('#date').value = new Date().toLocaleDateString();
    qs('#total').value = '$128.47';
    show('s3');
  }, 1200);
});

qs('#back1').onclick = ()=> show('s1');

qs('#toDoc').onclick = ()=>{
  const html = `
    <h2 style="margin:0 0 8px">Bill Intake — Filled</h2>
    <p><b>Account #:</b> ${esc(qs('#acct').value)}</p>
    <p><b>Name:</b> ${esc(qs('#name').value)}</p>
    <p><b>Date:</b> ${esc(qs('#date').value)}</p>
    <p><b>Total due:</b> ${esc(qs('#total').value)}</p>
    <hr><p style="font-size:12px;color:#666">Demo only. No storage.</p>`;
  qs('#doc').innerHTML = html;
  show('s4');
};

qs('#back2').onclick = ()=> show('s3');

qs('#submit').onclick = ()=>{
  show('s5');
  window.scrollTo({top:0,behavior:'smooth'});
};

qs('#restart').onclick = ()=>{
  if (fileURL) URL.revokeObjectURL(fileURL);
  file.value = ''; preview.style.display='none'; scan.disabled=true;
  show('s1');
};

qs('#print').onclick = (e)=>{
  e.preventDefault();
  const w = window.open('','_blank');
  const doc = `
    <html><head><title>Demo Document</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>body{font-family:system-ui,-apple-system,Arial;padding:20px}</style>
    </head><body>${qs('#doc').innerHTML}</body></html>`;
  w.document.write(doc);
  w.document.close();
};

function esc(s){return String(s||'').replace(/[&<>"']/g, c=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]) ); }
</script>
</body>
</html>
